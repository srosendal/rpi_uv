<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPi Visual Test Strip Analyzer</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="app-container">
        <!-- Header -->
        <header>
            <h1>Test Strip Analyzer</h1>
            <div id="header-controls">
                <button id="normal-mode-btn" class="header-btn active">Capture Mode</button>
                <button id="settings-mode-btn" class="header-btn">Settings Mode</button>
            </div>
        </header>

        <!-- Main Content -->
        <div id="main-content">
            <!-- Top Section: Two Columns -->
            <div id="top-section">
                <!-- Live View Section -->
                <div id="camera-section">
                <div id="camera-container">
                    <canvas id="camera-canvas" width="432" height="324"></canvas>
                    <svg id="roi-overlay" width="432" height="324">
                        <!-- ROI rectangles will be drawn here -->
                        <rect id="roi-1" class="roi-rect" x="125" y="95" width="150" height="20" />
                        <rect id="roi-2" class="roi-rect" x="125" y="145" width="150" height="20" />
                        <rect id="roi-3" class="roi-rect" x="125" y="195" width="150" height="20" />
                        <rect id="roi-4" class="roi-rect" x="125" y="245" width="150" height="20" />
                        <!-- ROI labels -->
                        <text id="label-1" class="roi-label" x="110" y="108">1</text>
                        <text id="label-2" class="roi-label" x="110" y="158">2</text>
                        <text id="label-3" class="roi-label" x="110" y="208">3</text>
                        <text id="label-4" class="roi-label" x="110" y="258">4</text>
                    </svg>
                </div>
                <div id="camera-info">
                    <span>Streaming: 432x324</span>
                    <span id="fps-counter">Streaming...</span>
                </div>
            </div>

                <!-- Control Panel -->
                <div id="control-panel">
                    <!-- Normal Mode Controls -->
                    <div id="normal-controls">
                        <div id="results-section">
                        <div id="results-grid">
                            <div class="result-item">
                                <span class="result-label">Stripe 1:</span>
                                <span id="result-1" class="result-value">---</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Stripe 2:</span>
                                <span id="result-2" class="result-value">---</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Stripe 3:</span>
                                <span id="result-3" class="result-value">---</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Stripe 4:</span>
                                <span id="result-4" class="result-value">---</span>
                            </div>
                        </div>
                        <div id="status-message"></div>
                        </div>
                    </div>

                    <!-- Settings Mode Controls -->
                    <div id="settings-controls" style="display: none;">
                    <div class="settings-group">
                        <div class="roi-selector">
                            <button class="roi-select-btn active" data-roi="1">ROI 1</button>
                            <button class="roi-select-btn" data-roi="2">ROI 2</button>
                            <button class="roi-select-btn" data-roi="3">ROI 3</button>
                            <button class="roi-select-btn" data-roi="4">ROI 4</button>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="mode-selector">
                            <button class="mode-btn active" data-mode="move">Move</button>
                            <button class="mode-btn" data-mode="increase">Increase</button>
                            <button class="mode-btn" data-mode="decrease">Decrease</button>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="direction-controls">
                            <button class="dir-btn" data-dir="up">▲</button>
                            <button class="dir-btn" data-dir="down">▼</button>
                            <button class="dir-btn" data-dir="left">◄</button>
                            <button class="dir-btn" data-dir="right">►</button>
                        </div>
                        <div class="movement-info">
                            <small>Step: <span id="step-size">5</span>px</small>
                        </div>
                    </div>

                    <div class="settings-group">
                        <input type="range" id="led-brightness" min="0" max="255" value="128">
                        <span id="led-value">128</span>
                    </div>

                    </div>
                </div>
            </div>

            <!-- Bottom Action Row -->
            <div id="action-row">
                <!-- Normal Mode Actions -->
                <div id="normal-actions">
                    <button id="capture-btn" class="primary-btn">
                        Capture & Analyze
                    </button>
                </div>
                
                <!-- Settings Mode Actions -->
                <div id="settings-actions" style="display: none;">
                    <button id="save-config-btn" class="action-btn">Save Config</button>
                    <button id="reset-config-btn" class="action-btn secondary">Reset</button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <p>Meka Innovation Pte Ltd</p>
        </footer>
    </div>

    <!-- Scripts -->
    <script src="js/image-analyzer.js"></script>
    <script src="js/roi-manager.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
